<?php
// +----------------------------------------------------------------------
// | ThinkPHP [ WE CAN DO IT JUST THINK ]
// +----------------------------------------------------------------------
// | Copyright (c) 2006-2016 http://thinkphp.cn All rights reserved.
// +----------------------------------------------------------------------
// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )
// +----------------------------------------------------------------------
// | Author: 流年 <liu21st@gmail.com>
// +----------------------------------------------------------------------

// 应用公共文件
//记录log
if (!function_exists('save_log')) {
    function save_log($path, $content, $mode = 'day')
    {
        $path = strval($path);
        $path = str_replace('\\', '/', trim($path, '/'));

        $content = strval($content);

        if (!$path || !$content) {
            return false;
        }
        $mode = in_array($mode, array('day', 'month', 'year')) ? $mode : 'day';
        $tempPath = config('log_dir') . '/' . $path . '/';

        if ($mode == 'day') {
            $tempPath .= date('Y') . '/' . date('m') . '/';
            $fileName  = date('d'). '.log';
        } elseif ($mode == 'month') {
            $tempPath .= date('Y') . '/';
            $fileName  = date('m'). '.log';
        } else {
            $fileName = date('Y') . 'log';
        }

        if (!file_exists($tempPath)) {
            if (!mkdir($tempPath, 0777, true)) {
                return false;
            }
        }

        $file    = $tempPath . $fileName;
        $content = date('Y-m-d H:i:s') . '#' . $content . "\r\n";
        $res     = @file_put_contents($file, $content, FILE_APPEND);
        if ($res) {
            return true;
        } else {
            return false;
        }
    }
}


/*
 * 生成随机数
 */
if (!function_exists('randomkeys')) {
    function randomkeys($length,$isnumber=false)
    {
        $arr     = array_merge(range(0, 9), range('a', 'z'));
        if($isnumber){
            $arr     = array_merge(range(0, 9));
        }

        $count = count($arr);
        $key ="";
        for($i=0;$i<$length;$i++)
        {
            if ($isnumber) {
                $key .= $arr[mt_rand(0, $count-1)];    //生成php随机数
            } else {
                $key .= $arr[mt_rand(0, $count-1)];    //生成php随机数
            }

        }
        return $key;
    }
}

//验证手机号
if (!function_exists('ismobile')) {
    function ismobile($mobile) {
        if(preg_match("/^1\d{10}$/",$mobile)){
            return true;
        }else{
            return false;
        }
    }
}
